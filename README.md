# car-directory

Я писал код на Java с использованием Spring framwork. 

Поддерживаемое API:
•	GET /cars/ - выводит весь список машин
	В случае если записей не было список будет пуст

•	GET /cars/id - выводит машину, с заданным id
  Если нет машины с заданным id выйдет ошибка

•	GET /cars/number - выводит машину, с заданным регистрационным номером
  Если нет машины с заданным регистрационным номером выйдет ошибка

•	POST /cars/ - принимает Json, на основе чего добавляет новую машину в базу данных. Пример Json запроса на добавление машины:
    {"number":"A888AA09","brand":"Rеno","color":"Black"}. (значения не могут быть пустыми)
	В случае если машина уже есть в БД выйдет ошибка, существование определяется по регистрационным номерам в БД.

•	POST /cars/delete – удаляет существующую машину по переданному id
	В случае если машины с заданным id не было выйдет ошибка

•	PUT /cars/update – обновляет информацию о существующей машине
  В случае если указанной записи не было выйдет ошибка. Изменить можно номера (если такие номера уже есть в БД выйдет ошибка) и цвет. Марку сменить нельзя

•	GET /cars/statistics – выводит статистику по справочнику: количество машин 
                                                            самая популярная марка
                                                            самый популярный цвет
                                                            дата первой записи
                                                            дата последнего обновления

•	GET /cars/statistics/brand – выводит все уникальные марки автомобилей из списка

•	GET /cars/statistics/color – выводит все уникальные цвета автомобилей из списка


О работе приложения:
Записи о машинах хранятся в БД. В таблице cars записи, описывающие состояние машины: id, number, brand, color, date. Получение запроса происходит в классе CarController, который находится в пакете controllers. CarController поддерживает стандартные CRUD операции над таблицей cars, а так же может выдавать статистику по записям, список уникальных марок и цветов.
![image](https://user-images.githubusercontent.com/67002782/176862287-604527fc-9cd5-474e-a314-ff73559823e7.png)


CarController не реализует никакой логики. CarController вызывает соответствующий метод из CarService, в котором реализована логика формирования ответа на запрос.
CarController:
![image](https://user-images.githubusercontent.com/67002782/176862361-31a5d127-86c0-4e24-9fc0-3a466d1c2189.png)
![image](https://user-images.githubusercontent.com/67002782/176862375-e97c0dbb-895a-4da5-bcde-b2a7dd03368c.png)


Ошибки, которые могут возникать в запросах, обрабатываются ExceptionHandler, который находится в пакете exception. Это ошибки при запросе (BAD_REQUEST), например неправильный Json при попытке добавить новую запись и ошибки при поиске записи в БД (NOT_FOUND), например: попытка обновления несуществующей записи.
![image](https://user-images.githubusercontent.com/67002782/176862433-7a40666a-5112-4c73-80f1-f701ef4ee322.png)


Работа происходит с двумя моделями Car и Statistics
Car, основная модель, с ней постоянно происходит работа. 
![image](https://user-images.githubusercontent.com/67002782/176862464-ba54f411-e6a2-4acc-9b5f-3243474867d4.png)
Car состоит из 5 параметров(id, number, brand, color, date) и 2 конструкторов(конструктор по умолчанию и конструктор с переменными: number, brand и color). Стандартные асессоры(Getter и Setter). Важный нюанс, явно задать дату нельзя, дата задаётся автоматически в момент создания экземпляра Car или обновляется с обновлением записи о машине. 
Переопределённые методы hashCode() и equals() в классе Car.
![image](https://user-images.githubusercontent.com/67002782/176862596-1848d1f4-483d-4e9a-b11b-37be0a38076f.png)


CarRepository интерфейс для работы с таблицей cars 
![image](https://user-images.githubusercontent.com/67002782/176862648-cb07c8bd-aaec-4de6-9d34-2ad2060b3707.png)

Statistics, которая выдаётся только при запросе /cars/statistics.
![image](https://user-images.githubusercontent.com/67002782/176862690-ba80aaba-cf36-4fab-ba7b-1b8e6aff43be.png)
Статистика выдаётся по требованию и не кэшируется, поэтому при каждом запросе статистики, статистика будет содержать актуальные данные.
Статистику по записям и список уникальных марок и цветов собирает сервис StatisticsService:
В нём все алгоритмы поиска необходимых данных, при этом он ничего не хранит и не кэширует, он просто собирает актуальные данные.



POST запрос добавление новой машины
![image](https://user-images.githubusercontent.com/67002782/176872497-22706939-fd0e-4b76-a330-06234010523f.png)

GET запрос получение статистики
![image](https://user-images.githubusercontent.com/67002782/176872948-8e0129dc-3eab-4aaf-a811-3128a2dd4441.png)

GET запрос получение уникальных цветов
![image](https://user-images.githubusercontent.com/67002782/176873271-f2c9dbbe-f61b-403e-b012-5380f2458627.png)

GET запрос получение уникальных марок
![image](https://user-images.githubusercontent.com/67002782/176873389-6e402119-29bb-48ad-9c83-ccb6ed9840c3.png)

GET запросы получение списка всех машин
![image](https://user-images.githubusercontent.com/67002782/176873608-c3521e73-c673-43c0-8191-caec079deab5.png)

GET запрос на получение машины по id
![image](https://user-images.githubusercontent.com/67002782/176874271-8c35b480-0df7-43bf-9f44-6014c24db286.png)

GET запрос на получение машины по регистрационному номеру
![image](https://user-images.githubusercontent.com/67002782/176874468-a0af27bc-c197-494f-a434-c1b0eda2b8cb.png)

POST запрос на удаление записи
![image](https://user-images.githubusercontent.com/67002782/176874071-b9593b28-b2c1-40fb-8452-eae8a7f45f09.png)

PUT запрос на изменение записи
![image](https://user-images.githubusercontent.com/67002782/176874661-f861fc09-d7ef-4aa5-a8c4-b1324a838791.png)






